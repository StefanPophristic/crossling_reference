df$response = str_replace_all(df$response, "crvenakanta\\b", "narukvica")
df$response = str_replace_all(df$response, "leptitr\\b", "leptir")
df$response = str_replace_all(df$response, "ljeptir\\b", "leptir")
df$response = str_replace_all(df$response, "crvenileptir\\b", "leptir")
df$response = str_replace_all(df$response, "tarta\\b", "torta")
df$response = str_replace_all(df$response, "torte\\b", "torta")
df$response = str_replace_all(df$response, "tortsa\\b", "torta")
df$response = str_replace_all(df$response, "calculator\\b", "kalkulator")
df$response = str_replace_all(df$response, "kalkulato\\b", "kalkulator")
df$response = str_replace_all(df$response, "dzepnoracunalo\\b", "racunalo")
df$response = str_replace_all(df$response, "zutikalkulator\\b", "kalkulator")
df$response = str_replace_all(df$response, "koledar\\b", "kalendar")
df$response = str_replace_all(df$response, "kalender\\b", "kalendar")
df$response = str_replace_all(df$response, "koleendar\\b", "kalendar")
df$response = str_replace_all(df$response, "kolendar\\b", "kalendar")
df$response = str_replace_all(df$response, "kolodar\\b", "kalendar")
df$response = str_replace_all(df$response, "foto-aparat\\b", "fotoaparat")
df$response = str_replace_all(df$response, "analognifotoaparat\\b", "fotoaparat")
df$response = str_replace_all(df$response, "kumera\\b", "kamera")
df$response = str_replace_all(df$response, "narancastakamera\\b", "kamera")
df$response = str_replace_all(df$response, "camara\\b", "kamera")
df$response = str_replace_all(df$response, "svijeca\\b", "sveca")
df$response = str_replace_all(df$response, "svejca\\b", "sveca")
df$response = str_replace_all(df$response, "svijca\\b", "sveca")
df$response = str_replace_all(df$response, "svjiec\\b", "sveca")
df$response = str_replace_all(df$response, "sijeca\\b", "sveca")
df$response = str_replace_all(df$response, "svece\\b", "sveca")
df$response = str_replace_all(df$response, "capu\\b", "kapa")
df$response = str_replace_all(df$response, "bijelakapa\\b", "kapa")
df$response = str_replace_all(df$response, "zutakapa\\b", "kapa")
df$response = str_replace_all(df$response, "stolivca\\b", "stolica")
df$response = str_replace_all(df$response, "satt\\b", "sat")
df$response = str_replace_all(df$response, "crvenabudilica\\b", "budilica")
df$response = str_replace_all(df$response, "alarmsat\\b", "alarm-sat")
df$response = str_replace_all(df$response, "satalarm\\b", "alarm-sat")
df$response = str_replace_all(df$response, "alarma\\b", "alarm")
df$response = str_replace_all(df$response, "budilnica\\b", "budilica")
df$response = str_replace_all(df$response, "budnica\\b", "budilica")
df$response = str_replace_all(df$response, "satbudilica\\b", "budilica")
df$response = str_replace_all(df$response, "stonisat\\b", "sat")
df$response = str_replace_all(df$response, "zutisat\\b", "sat")
df$response = str_replace_all(df$response, "hanger\\b", "ofinger")
df$response = str_replace_all(df$response, "ovinger\\b", "ofinger")
df$response = str_replace_all(df$response, "objesalnik\\b", "obesalnik")
df$response = str_replace_all(df$response, "besalicabesalica\\b", "vesalica")
df$response = str_replace_all(df$response, "bijelavjesalica\\b", "vesalica")
df$response = str_replace_all(df$response, "visalica\\b", "vesalica")
df$response = str_replace_all(df$response, "ceselj\\b", "cesalj")
df$response = str_replace_all(df$response, "casalj\\b", "cesalj")
df$response = str_replace_all(df$response, "cesel\\b", "cesalj")
df$response = str_replace_all(df$response, "zuticesalj\\b", "cesalj")
df$response = str_replace_all(df$response, "krovna\\b", "kruna")
df$response = str_replace_all(df$response, "corona\\b", "kruna")
df$response = str_replace_all(df$response, "kryna\\b", "kruna")
df$response = str_replace_all(df$response, "jastug\\b", "jastuk")
df$response = str_replace_all(df$response, "ukrasnijastuk\\b", "jastuk")
df$response = str_replace_all(df$response, "jastukl\\b", "jastuk")
df$response = str_replace_all(df$response, "zutijastuk\\b", "jastuk")
df$response = str_replace_all(df$response, "kockica\\b", "kocka")
df$response = str_replace_all(df$response, "kocke\\b", "kocka")
df$response = str_replace_all(df$response, "kockazaigranje\\b", "kocka")
df$response = str_replace_all(df$response, "kocke\\b", "kocka")
df$response = str_replace_all(df$response, "kotcka\\b", "kocka")
df$response = str_replace_all(df$response, "kocku\\b", "kocka")
df$response = str_replace_all(df$response, "ljubicastakocka\\b", "kocka")
df$response = str_replace_all(df$response, "brata\\b", "vrata")
df$response = str_replace_all(df$response, "vratu\\b", "vrata")
df$response = str_replace_all(df$response, "plavahaljina\\b", "haljina")
df$response = str_replace_all(df$response, "odjeca\\b", "odeca")
df$response = str_replace_all(df$response, "hsljina\\b", "haljina")
df$response = str_replace_all(df$response, "belahaljina\\b", "haljina")
df$response = str_replace_all(df$response, "hajlina\\b", "haljina")
df$response = str_replace_all(df$response, "haljuna\\b", "haljina")
df$response = str_replace_all(df$response, "omar\\b", "ormar")
df$response = str_replace_all(df$response, "orman\\b", "ormar")
df$response = str_replace_all(df$response, "ormarsaladicama\\b", "ormar")
df$response = str_replace_all(df$response, "zelenakomoda\\b", "komoda")
df$response = str_replace_all(df$response, "zeleniormaric\\b", "ormar")
df$response = str_replace_all(df$response, "buban\\b", "bubanj")
df$response = str_replace_all(df$response, "boban\\b", "bubanj")
df$response = str_replace_all(df$response, "bubabj\\b", "bubanj")
df$response = str_replace_all(df$response, "dubanj\\b", "bubanj")
df$response = str_replace_all(df$response, "bybanj\\b", "bubanj")
df$response = str_replace_all(df$response, "boben\\b", "bubanj")
df$response = str_replace_all(df$response, "boban\\b", "bubanj")
df$response = str_replace_all(df$response, "gumenapatkica\\b", "gumenapatka")
df$response = str_replace_all(df$response, "patkicazakupanje\\b", "patkazakupanje")
df_split <- runAnalysis(df)
df_split <- runAnalysis(df)
# Take in tibble
# Return how many people responded the most common answer
# this is accross colors
getPercent <- function(objectName) {
tib <- df_split[[objectName]]
totalSum <- tib$count %>%
sum()
maxCount <- tib %>%
group_by(cresponse) %>%
summarise(n = sum(count))
maxNum <- maxCount[which.max(maxCount$n),]$n
return(maxNum/totalSum)
}
getLabel <- function(objectName) {
tib <- df_split[[objectName]]
maxCount <- tib %>%
group_by(cresponse) %>%
summarise(n = sum(count))
return(maxCount[which.max(maxCount$n),][[1]])
}
allNames <- names(df_split)
df_percent <- data.frame(item = allNames,
label = unlist(lapply(allNames, getLabel)),
percent = unlist(lapply(allNames, getPercent)))
#append gender and color scheme:
df_targets <- read.csv("../../../shared/final_targets.csv", header = TRUE)
df_targets <- df_targets %>%
filter(Color == "blue" | Color == "green") %>%
select(Item, Color.scheme, Gender)
colnames(df_targets) <- c("item", "colorScheme", "gender")
df_percent <- merge(df_targets, df_percent,by = c("item"))
df_percent %>%
filter(percent >= 0.7) %>%
summarise(n()) %>%
view()
df_percent %>%
filter(percent <= 0.7) %>%
summarise(n()) %>%
view()
# Color scheme 1
df_percent %>%
group_by(gender) %>%
filter(colorScheme == 1 & percent >= 0.7) %>%
summarise(n()) %>%
view()
# Check the feminine items and see what is up
df_percent %>%
filter(colorScheme == 1 & gender == "F") %>%
view()
view(df)
# Check the feminine items and see what is up
df_percent %>%
filter(colorScheme == 1 & gender == "M") %>%
view()
# color scheme 2:
df_percent %>%
group_by(gender) %>%
filter(colorScheme == 2 & percent >= 0.7) %>%
summarise(n()) %>%
view()
# Check the feminine items and see what is up
df_percent %>%
filter(colorScheme == 1 & gender == "F") %>%
view()
# Check the feminine items and see what is up
df_percent %>%
filter(colorScheme == 2 & gender == "F") %>%
view()
# Check the feminine items and see what is up
df_percent %>%
filter(colorScheme == 2 & gender == "M") %>%
view()
df_percent
df_percent %>%
filter(percent >= 0.7) %>%
summarise(n())
df_percent %>%
filter(percent <= 0.7) %>%
summarise(n())
df_percent %>%
group_by(gender) %>%
filter(colorScheme == 1 & percent >= 0.7) %>%
summarise(n())
df_percent %>%
filter(colorScheme == 1 & gender == "F")
df_percent %>%
filter(colorScheme == 1 & gender == "F") %>%
arrange(percent)
df_percent %>%
filter(colorScheme == 1 & gender == "M") %>%
arrange(percent)
df_percent %>%
group_by(gender) %>%
filter(colorScheme == 2 & percent >= 0.7) %>%
summarise(n())
df_percent %>%
filter(colorScheme == 2 & gender == "F") %>%
arrange(percent)
library(tidyverse)
theme_set(theme_bw())
source("../../../shared/analysis.R")
df = read.csv("../data/1_noun_norming_main-merged_cleaned.csv", header = TRUE)
df2 = read.csv("../data/1_noun_norming_fluent-merged_cleaned.csv", header = TRUE)
df <- rbind(df, df2)
subjectCleanUp <- df %>%
select(workerid, schoolLanguage, firstLanguage, status) %>%
unique()
#view(subjectCleanUp)
# There are "statuses" that are coded incorrectly. These incorrect codings are due to spelling errors and
# listing two or more languages split up by / rather than spaces and commas
# Manually input them into the dataframe
df$status[df$workerid == 272] <- "heritage"
df$status[df$workerid == 248] <- "native"
df$status[df$workerid == 241] <- "heritage"
df$status[df$workerid == 274] <- "heritage"
df$status[df$workerid == 232] <- "native"
df$status[df$workerid == 394] <- "heritage"
df$status[df$workerid == 337] <- "native"
df$status[df$workerid == 402] <- "simk"
df$status[df$workerid == 152] <- "native"
df$status[df$workerid == 169] <- "native"
df$status[df$workerid == 262] <- "native"
df$status[df$workerid == 154] <- "native"
df$status[df$workerid == 423] <- "foreign"
# get rid of participants who answered with colors
# Get rid of participants who clearly used google translate (gvozdje instead of pegla and umreti instead of kocka)
df <- df %>%
filter(workerid != 214 &
workerid != 333 &
workerid != 346 &
workerid != 261 &
workerid != 357)
# get rid of SIMK and foreign speakers
df <- df %>%
filter(status != "simk" & status != "foreign")
# Standardize spellings for ease
df$response = str_to_lower(str_replace_all(df$response, " ", ""))
df$response = str_to_lower(str_replace_all(df$response, "\n", ""))
df$response = str_replace_all(df$response, "č", "c")
df$response = str_replace_all(df$response,"ć", "c")
df$response = str_replace_all(df$response,"š", "s")
df$response = str_replace_all(df$response,"ž", "z")
df$response = str_replace_all(df$response,"đ", "dj")
# Change answers to account for spelling differences
# I only got through some responses before giving up on this method
df$response = str_replace_all(df$response, "avijon\\b", "avion")
df$response = str_replace_all(df$response, "putnickiavion\\b", "avion")
df$response = str_replace_all(df$response, "zelenizrakoplov\\b", "zrakoplov")
df$response = str_replace_all(df$response, "fotelj\\b", "fotelja")
df$response = str_replace_all(df$response, "fotelj\\b", "fatelja")
df$response = str_replace_all(df$response, "stolca\\b", "stolica")
df$response = str_replace_all(df$response, "stolcu\\b", "stolica")
df$response = str_replace_all(df$response, "balun\\b", "balon")
df$response = str_replace_all(df$response, "zutibalon\\b", "balon")
df$response = str_replace_all(df$response, "hansaplast\\b", "hanzaplast")
df$response = str_replace_all(df$response, "hanzaflast\\b", "hanzaplast")
df$response = str_replace_all(df$response, "hansaflast\\b", "hanzaplast")
df$response = str_replace_all(df$response, "hanzoplast\\b", "hanzaplast")
df$response = str_replace_all(df$response, "flajster\\b", "flaster")
df$response = str_replace_all(df$response, "plaster\\b", "flaster")
df$response = str_replace_all(df$response, "flastir\\b", "flaster")
df$response = str_replace_all(df$response, "bandaza\\b", "bandaz")
df$response = str_replace_all(df$response, "ljubicastiplaster\\b", "flaster")
df$response = str_replace_all(df$response, "korba\\b", "korpa")
df$response = str_replace_all(df$response, "korpica\\b", "korpa")
df$response = str_replace_all(df$response, "kosarica\\b", "kosara")
df$response = str_replace_all(df$response, "kosaricazakupovinu\\b", "kosara")
df$response = str_replace_all(df$response, "zelenakosarica\\b", "kosara")
df$response = str_replace_all(df$response, "pletenakosara\\b", "kosara")
df$response = str_replace_all(df$response, "slamnatakosara\\b", "kosara")
df$response = str_replace_all(df$response, "krever\\b", "krevet")
df$response = str_replace_all(df$response, "plavikrevet\\b", "krevet")
df$response = str_replace_all(df$response, "bracnikrevet\\b", "krevet")
df$response = str_replace_all(df$response, "kajs\\b", "kais")
df$response = str_replace_all(df$response, "kajis\\b", "kais")
df$response = str_replace_all(df$response, "kajis\\b", "kais")
df$response = str_replace_all(df$response, "klop\\b", "klupa")
df$response = str_replace_all(df$response, "klup\\b", "klupa")
df$response = str_replace_all(df$response, "klupica\\b", "klupa")
df$response = str_replace_all(df$response, "klopca\\b", "klupa") #this is the Slovenian word
df$response = str_replace_all(df$response, "drvenaklupa\\b", "klupa")
df$response = str_replace_all(df$response, "klupic\\b", "klupa")
df$response = str_replace_all(df$response, "bickil\\b", "bicikl")
df$response = str_replace_all(df$response, "plavibicikl\\b", "bicikl")
df$response = str_replace_all(df$response, "bicikel\\b", "bicikl")
df$response = str_replace_all(df$response, "loptica\\b", "lopta")
df$response = str_replace_all(df$response, "biljarskakugla\\b", "biljardkugla")
df$response = str_replace_all(df$response, "neznamrijeczato.nijesekoristiloujugoslavijitoliko\\b", "neznam")
df$response = str_replace_all(df$response, "neznamstajetacnoovo\\b", "neznam")
df$response = str_replace_all(df$response, "nezanm\\:\\)\\b", "neznam")
df$response = str_replace_all(df$response, "neznamstajeto\\b", "neznam")
df$response = str_replace_all(df$response, "mapu\\b", "mapa")
df$response = str_replace_all(df$response, "zutifolder\\b", "folder")
df$response = str_replace_all(df$response, "zaboravilasam.googlekazedvogledalimislimdasmotozvalidrukcije\\b", "neznam")
df$response = str_replace_all(df$response, "nemogusesjetiti\\b", "neznam")
df$response = str_replace_all(df$response, "bonbon\\b", "bombon")
df$response = str_replace_all(df$response, "bonbona\\b", "bombona")
df$response = str_replace_all(df$response, "bombone\\b", "bombona")
df$response = str_replace_all(df$response, "bmbon\\b", "bombon")
df$response = str_replace_all(df$response, "bonobn\\b", "bombon")
df$response = str_replace_all(df$response, "onbon\\b", "bombon")
df$response = str_replace_all(df$response, "ljubicastiomotzabonbon\\b", "bombon")
df$response = str_replace_all(df$response, "bon-bona\\b", "bombona")
df$response = str_replace_all(df$response, "kniga\\b", "knjiga")
df$response = str_replace_all(df$response, "crvenaknjiga\\b", "knjiga")
df$response = str_replace_all(df$response, "knjigu\\b", "knjiga")
df$response = str_replace_all(df$response, "biljeznica\\b", "beleznica")
df$response = str_replace_all(df$response, "kgniga\\b", "knjiga")
df$response = str_replace_all(df$response, "knjig\\b", "knjiga")
df$response = str_replace_all(df$response, "cizme\\b", "cizma")
df$response = str_replace_all(df$response, "cipele\\b", "cipela")
df$response = str_replace_all(df$response, "cisma\\b", "cizma")
df$response = str_replace_all(df$response, "cizmica\\b", "cizma")
df$response = str_replace_all(df$response, "gleznjace\\b", "gleznjaca")
df$response = str_replace_all(df$response, "cisme\\b", "cizma")
df$response = str_replace_all(df$response, "tsipale\\b", "cipela")
df$response = str_replace_all(df$response, "smedjecizme\\b", "cizma")
df$response = str_replace_all(df$response, "zdela\\b", "zdjela")
df$response = str_replace_all(df$response, "zdjelica\\b", "zdjela")
df$response = str_replace_all(df$response, "duboktanjir\\b", "tanjir")
df$response = str_replace_all(df$response, "dubokitanjir\\b", "tanjir")
df$response = str_replace_all(df$response, "tanjur\\b", "tanjir")
df$response = str_replace_all(df$response, "zdelja\\b", "zdjela")
df$response = str_replace_all(df$response, "dubljitanjir\\b", "tanjir")
df$response = str_replace_all(df$response, "posudja\\b", "posuda")
df$response = str_replace_all(df$response, "zdejla\\b", "zdjela")
df$response = str_replace_all(df$response, "crnakutija\\b", "kutija")
df$response = str_replace_all(df$response, "kutiju\\b", "kutija")
df$response = str_replace_all(df$response, "kartonskakutija\\b", "kutija")
df$response = str_replace_all(df$response, "kutia\\b", "kutija")
df$response = str_replace_all(df$response, "ljubicastakutija\\b", "kutija")
df$response = str_replace_all(df$response, "naruknica\\b", "narukvica")
df$response = str_replace_all(df$response, "ogrlice\\b", "ogrlica")
df$response = str_replace_all(df$response, "crvenarukvica\\b", "narukvica")
df$response = str_replace_all(df$response, "narukvica(brojanica)\\b", "narukvica")
df$response = str_replace_all(df$response, "narukvica\\?\\b", "narukvica")
df$response = str_replace_all(df$response, "bisernaogrlica\\b", "ogrlica")
df$response = str_replace_all(df$response, "narokvica\\b", "narukvica")
df$response = str_replace_all(df$response, "kantica\\b", "kanta")
df$response = str_replace_all(df$response, "crvenakanta\\b", "narukvica")
df$response = str_replace_all(df$response, "korpica\\b", "korpa")
df$response = str_replace_all(df$response, "leptitr\\b", "leptir")
df$response = str_replace_all(df$response, "ljeptir\\b", "leptir")
df$response = str_replace_all(df$response, "crvenileptir\\b", "leptir")
df$response = str_replace_all(df$response, "leptiri\\b", "leptir")
df$response = str_replace_all(df$response, "tarta\\b", "torta")
df$response = str_replace_all(df$response, "cokoladnikolac\\b", "kolac")
df$response = str_replace_all(df$response, "torte\\b", "torta")
df$response = str_replace_all(df$response, "tortsa\\b", "torta")
df$response = str_replace_all(df$response, "l+kalkulator\\b", "kalkulator")
df$response = str_replace_all(df$response, "calculator\\b", "kalkulator")
df$response = str_replace_all(df$response, "kalkulato\\b", "kalkulator")
df$response = str_replace_all(df$response, "racunalp\\b", "racunar")
df$response = str_replace_all(df$response, "dzepnoracunalo\\b", "racunalo")
df$response = str_replace_all(df$response, "zutikalkulator\\b", "kalkulator")
df$response = str_replace_all(df$response, "koledar\\b", "kalendar")
df$response = str_replace_all(df$response, "crnikalendar\\b", "kalendar")
df$response = str_replace_all(df$response, "kalender\\b", "kalendar")
df$response = str_replace_all(df$response, "koleendar\\b", "kalendar")
df$response = str_replace_all(df$response, "calendar\\b", "kalendar")
df$response = str_replace_all(df$response, "kolendar\\b", "kalendar")
df$response = str_replace_all(df$response, "kolodar\\b", "kalendar")
df$response = str_replace_all(df$response, "laendar\\b", "kalendar")
df$response = str_replace_all(df$response, "foto-aparat\\b", "fotoaparat")
df$response = str_replace_all(df$response, "analognifotoaparat\\b", "fotoaparat")
df$response = str_replace_all(df$response, "kamera\\?\\b", "kamera")
df$response = str_replace_all(df$response, "kumera\\b", "kamera")
df$response = str_replace_all(df$response, "camera\\b", "kamera")
df$response = str_replace_all(df$response, "narancastakamera\\b", "kamera")
df$response = str_replace_all(df$response, "camara\\b", "kamera")
df$response = str_replace_all(df$response, "insta/polaroidkamera\\b", "kamera")
df$response = str_replace_all(df$response, "svijeca\\b", "sveca")
df$response = str_replace_all(df$response, "svejca\\b", "sveca")
df$response = str_replace_all(df$response, "svica\\b", "sveca")
df$response = str_replace_all(df$response, "svijca\\b", "sveca")
df$response = str_replace_all(df$response, "svjiec\\b", "sveca")
df$response = str_replace_all(df$response, "svjeca\\b", "sveca")
df$response = str_replace_all(df$response, "sijeca\\b", "sveca")
df$response = str_replace_all(df$response, "svece\\b", "sveca")
df$response = str_replace_all(df$response, "zutasvijeca\\b", "sveca")
df$response = str_replace_all(df$response, "capu\\b", "kapa")
df$response = str_replace_all(df$response, "bijelakapa\\b", "kapa")
df$response = str_replace_all(df$response, "kapa\\?\\b", "kapa")
df$response = str_replace_all(df$response, "zutakapa\\b", "kapa")
df$response = str_replace_all(df$response, "stolivca\\b", "stolica")
df$response = str_replace_all(df$response, "budilnica\\b", "budilica")
df$response = str_replace_all(df$response, "satt\\b", "sat")
df$response = str_replace_all(df$response, "crvenabudilica\\b", "budilica")
df$response = str_replace_all(df$response, "alarmsat\\b", "alarm-sat")
df$response = str_replace_all(df$response, "sat/alarm\\b", "alarm-sat")
df$response = str_replace_all(df$response, "satalarm\\b", "alarm-sat")
df$response = str_replace_all(df$response, "alarma\\b", "alarm")
df$response = str_replace_all(df$response, "budilca\\b", "budilica")
df$response = str_replace_all(df$response, "budilnica\\b", "budilica")
df$response = str_replace_all(df$response, "budnica\\b", "budilica")
df$response = str_replace_all(df$response, "satbudilica\\b", "budilica")
df$response = str_replace_all(df$response, "say\\b", "sat")
df$response = str_replace_all(df$response, "stonisat\\b", "sat")
df$response = str_replace_all(df$response, "zutisat\\b", "sat")
df$response = str_replace_all(df$response, "vjesalica\\b", "vesalica")
df$response = str_replace_all(df$response, "hanger\\b", "ofinger")
df$response = str_replace_all(df$response, "ovinger\\b", "ofinger")
df$response = str_replace_all(df$response, "vesaljica\\b", "vesalica")
df$response = str_replace_all(df$response, "objesalnik\\b", "obesalnik")
df$response = str_replace_all(df$response, "besalicabesalica\\b", "vesalica")
df$response = str_replace_all(df$response, "aufinger\\b", "ofinger")
df$response = str_replace_all(df$response, "bijelavjesalica\\b", "vesalica")
df$response = str_replace_all(df$response, "visalica\\b", "vesalica")
df$response = str_replace_all(df$response, "vzglavnik\\b", "glavnik")
df$response = str_replace_all(df$response, "ceselj\\b", "cesalj")
df$response = str_replace_all(df$response, "casalj\\b", "cesalj")
df$response = str_replace_all(df$response, "cesaljzakosu\\b", "cesalj")
df$response = str_replace_all(df$response, "cesel\\b", "cesalj")
df$response = str_replace_all(df$response, "zuticesalj\\b", "cesalj")
df$response = str_replace_all(df$response, "krona\\b", "kruna")
df$response = str_replace_all(df$response, "krovna\\b", "kruna")
df$response = str_replace_all(df$response, "corona\\b", "kruna")
df$response = str_replace_all(df$response, "kryna\\b", "kruna")
df$response = str_replace_all(df$response, "jastuce\\b", "jastuk")
df$response = str_replace_all(df$response, "jastug\\b", "jastuk")
df$response = str_replace_all(df$response, "ukrasnijastuk\\b", "jastuk")
df$response = str_replace_all(df$response, "jastucic\\b", "jastuk")
df$response = str_replace_all(df$response, "jastukl\\b", "jastuk")
df$response = str_replace_all(df$response, "zutijastuk\\b", "jastuk")
df$response = str_replace_all(df$response, "zutjastuk\\b", "jastuk")
df$response = str_replace_all(df$response, "kockica\\b", "kocka")
df$response = str_replace_all(df$response, "kocke\\b", "kocka")
df$response = str_replace_all(df$response, "kockazaigranje\\b", "kocka")
df$response = str_replace_all(df$response, "kocak\\b", "kocka")
df$response = str_replace_all(df$response, "kocke\\b", "kocka")
df$response = str_replace_all(df$response, "kotcka\\b", "kocka")
df$response = str_replace_all(df$response, "kocika\\b", "kocka")
df$response = str_replace_all(df$response, "kocku\\b", "kocka")
df$response = str_replace_all(df$response, "ljubicastakocka\\b", "kocka")
df$response = str_replace_all(df$response, "bijelavrataidovratak\\b", "vrata")
df$response = str_replace_all(df$response, "brata\\b", "vrata")
df$response = str_replace_all(df$response, "vratu\\b", "vrata")
df$response = str_replace_all(df$response, "zutavrata\\b", "vrata")
df$response = str_replace_all(df$response, "plavahaljina\\b", "haljina")
df$response = str_replace_all(df$response, "odjeca\\b", "odeca")
df$response = str_replace_all(df$response, "haljinu\\b", "haljina")
df$response = str_replace_all(df$response, "hsljina\\b", "haljina")
df$response = str_replace_all(df$response, "belahaljina\\b", "haljina")
df$response = str_replace_all(df$response, "hsljina\\b", "haljina")
df$response = str_replace_all(df$response, "hajlina\\b", "haljina")
df$response = str_replace_all(df$response, "haljuna\\b", "haljina")
df$response = str_replace_all(df$response, "ormaric\\b", "ormar")
df$response = str_replace_all(df$response, "omar\\b", "ormar")
df$response = str_replace_all(df$response, "orman\\b", "ormar")
df$response = str_replace_all(df$response, "ormarica\\b", "ormar")
df$response = str_replace_all(df$response, "ormarsaladicama\\b", "ormar")
df$response = str_replace_all(df$response, "zelenakomoda\\b", "komoda")
df$response = str_replace_all(df$response, "zeleniormaric\\b", "ormar")
df$response = str_replace_all(df$response, "ljubicastakomoda\\b", "komoda")
df$response = str_replace_all(df$response, "buban\\b", "bubanj")
df$response = str_replace_all(df$response, "boban\\b", "bubanj")
df$response = str_replace_all(df$response, "bobni\\b", "bubanj")
df$response = str_replace_all(df$response, "bubabj\\b", "bubanj")
df$response = str_replace_all(df$response, "dubanj\\b", "bubanj")
df$response = str_replace_all(df$response, "malibubanj\\b", "bubanj")
df$response = str_replace_all(df$response, "bybanj\\b", "bubanj")
df$response = str_replace_all(df$response, "boben\\b", "bubanj")
df$response = str_replace_all(df$response, "boban\\b", "bubanj")
df$response = str_replace_all(df$response, "patkica\\b", "patka")
df$response = str_replace_all(df$response, "gumenapatkica\\b", "gumenapatka")
df$response = str_replace_all(df$response, "patkicazakupanje\\b", "patkazakupanje")
df$response = str_replace_all(df$response, "patke\\b", "patka")
df_split <- runAnalysis(df)
## Do people have a majority response over a 70% threshold?
# Input: string refering to object in df_split
# output: Return the percent of people responded the most common answer
getPercent <- function(objectName) {
tib <- df_split[[objectName]]
totalSum <- tib$count %>%
sum()
maxCount <- tib %>%
group_by(cresponse) %>%
summarise(n = sum(count))
maxNum <- maxCount[which.max(maxCount$n),]$n
return(maxNum/totalSum)
}
# Input: string refering to object in df_split
# output: Return the the most common esponse
getLabel <- function(objectName) {
tib <- df_split[[objectName]]
maxCount <- tib %>%
group_by(cresponse) %>%
summarise(n = sum(count))
return(maxCount[which.max(maxCount$n),][[1]])
}
allNames <- names(df_split)
# create dataframe with most common responses
# and percent of people that responded with them
df_percent <- data.frame(item = allNames,
label = unlist(lapply(allNames, getLabel)),
percent = unlist(lapply(allNames, getPercent)))
#append gender and color scheme to the df_percent
df_targets <- read.csv("../../../shared/final_targets.csv", header = TRUE)
df_targets <- df_targets %>%
filter(Color == "blue" | Color == "green") %>%
select(Item, Color.scheme, Gender)
colnames(df_targets) <- c("item", "colorScheme", "gender")
df_percent <- merge(df_targets, df_percent,by = c("item"))
# Function that takes in an object name and prints a plot of responses
# for that objects
makePlots <- function(objectName) {
x <- plot_df_subset(df_split[[objectName]], objectName)
x
}
df_percent
df_percent %>%
filter(percent >= 0.7) %>%
summarise(n())
df_percent %>%
filter(percent <= 0.7) %>%
summarise(n())
df_percent %>%
group_by(gender) %>%
filter(colorScheme == 1 & percent >= 0.7) %>%
summarise(n())
df_percent %>%
filter(colorScheme == 1 & gender == "F") %>%
arrange(percent)
